<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¤§ç­æ•™å­¦ï¼šå¯æ‹¨åŠ¨äº’åŠ¨æ—¶é’Ÿ</title>
    <style>
        body { 
            font-family: 'Comic Sans MS', 'Microsoft YaHei', sans-serif; 
            background-color: #e0f7fa; 
            display: flex; flex-direction: column; align-items: center; justify-content: center; 
            height: 100vh; margin: 0; 
            user-select: none; /* ç¦æ­¢é€‰ä¸­æ–‡æœ¬ */
            touch-action: none; /* ç¦æ­¢è§¦æ‘¸å±å¹•æ—¶çš„é»˜è®¤æ»šåŠ¨ï¼Œæ–¹ä¾¿æ‹–æ‹½ */
        }
        h1 { color: #006064; margin-bottom: 10px; text-shadow: 1px 1px 2px rgba(0,0,0,0.1); pointer-events: none; }
        p { color: #555; margin-bottom: 20px; font-size: 14px; pointer-events: none; }

        /* æ—¶é’Ÿå¤–å£³ */
        .clock {
            width: 320px; height: 320px;
            background-color: white;
            border: 15px solid #ffab91;
            border-radius: 50%;
            position: relative;
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
            background-image: radial-gradient(circle, #fff 60%, #f5f5f5 100%);
        }
        
        /* åˆ»åº¦æ•°å­— */
        .number {
            position: absolute; width: 30px; height: 30px;
            text-align: center; line-height: 30px; font-weight: bold; font-size: 26px; color: #4e342e;
            top: 50%; left: 50%;
            z-index: 2; pointer-events: none;
        }

        /* åˆ»åº¦çº¿ */
        .tick {
            position: absolute; width: 2px; height: 10px; background: #ddd;
            top: 0; left: 50%; transform-origin: 0 160px;
            z-index: 1; pointer-events: none;
        }
        .tick.large { width: 4px; height: 15px; background: #ff7043; }

        /* ä¸­å¿ƒç‚¹ */
        .center-dot {
            width: 18px; height: 18px; background: #37474f; border-radius: 50%;
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 20;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3); pointer-events: none;
        }

        /* æŒ‡é’ˆé€šç”¨æ ·å¼ - å¢åŠ  grab é¼ æ ‡æ‰‹åŠ¿ */
        .hand {
            position: absolute; bottom: 50%; left: 50%;
            transform-origin: bottom center;
            border-radius: 10px; z-index: 10;
            box-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            cursor: grab;
        }
        .hand:active { cursor: grabbing; }

        /* å¢åŠ é€æ˜è§¦æ‘¸åŒºåŸŸï¼Œè®©æ‰‹æŒ‡æ›´å®¹æ˜“æŒ‰ä½ */
        .hand::after {
            content: ''; position: absolute;
            left: -20px; right: -20px; top: -20px; bottom: -20px;
        }
        
        /* æ—¶é’ˆ */
        .hour-hand {
            width: 12px; height: 75px; background-color: #37474f; z-index: 11;
        }
        
        /* åˆ†é’ˆ */
        .minute-hand {
            width: 8px; height: 115px; background-color: #00bcd4; z-index: 12;
        }

        /* æ•°å­—æ˜¾ç¤ºå± */
        .display-time { 
            margin-top: 25px; 
            font-size: 40px; 
            font-family: monospace; 
            font-weight: bold; 
            color: #00838f; 
            background: #fff;
            padding: 5px 20px;
            border-radius: 10px;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.1);
            pointer-events: none;
        }

        /* æ“ä½œé¢æ¿ */
        .controls { margin-top: 20px; display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; max-width: 500px; }
        .btn-group { display: flex; gap: 5px; background: rgba(255,255,255,0.6); padding: 5px; border-radius: 12px; }

        button {
            padding: 10px 15px; font-size: 15px; border: none; border-radius: 8px;
            cursor: pointer; font-weight: bold;
            transition: transform 0.1s;
            box-shadow: 0 3px 0 rgba(0,0,0,0.2);
        }
        button:active { transform: translateY(3px); box-shadow: none; }

        .btn-hour { background-color: #ffcc80; color: #5d4037; }
        .btn-min { background-color: #80deea; color: #006064; }
        .btn-reset { background-color: #ffab91; color: #bf360c; }

    </style>
</head>
<body>

    <h1>ğŸ•°ï¸ å¥‡å¦™æ—¶é’Ÿï¼šæ‹¨ä¸€æ‹¨</h1>
    <p>æ—¢å¯ä»¥ç‚¹æŒ‰é’®ï¼Œä¹Ÿå¯ä»¥ç”¨æ‰‹ç›´æ¥æ‹¨åŠ¨æŒ‡é’ˆå“¦ï¼</p>
    
    <div class="clock" id="clockFace">
        <div id="ticks"></div>
        <div id="numbers"></div>
        <div class="center-dot"></div>
        
        <div class="hand hour-hand" id="hourHand" data-type="hour"></div>
        <div class="hand minute-hand" id="minuteHand" data-type="minute"></div>
    </div>

    <div class="display-time" id="timeDisplay">12:00</div>

    <div class="controls">
        <div class="btn-group">
            <button class="btn-hour" onclick="addTimeButton(60)">+1 å°æ—¶</button>
            <button class="btn-hour" onclick="setSpecificTime(9, 0)">ğŸ•˜ 9ç‚¹</button>
            <button class="btn-hour" onclick="setSpecificTime(3, 0)">ğŸ•’ 3ç‚¹</button>
        </div>

        <div class="btn-group">
            <button class="btn-min" onclick="addTimeButton(1)">+1 åˆ†</button>
            <button class="btn-min" onclick="addTimeButton(5)">+5 åˆ†</button>
            <button class="btn-min" onclick="addTimeButton(30)">+30 åˆ†</button>
        </div>

        <div class="btn-group">
            <button class="btn-reset" onclick="resetTime()">ğŸ”„ é‡ç½®</button>
        </div>
    </div>

    <script>
        // --- åˆå§‹åŒ–è¡¨ç›˜ (å’Œä¸Šä¸ªç‰ˆæœ¬ä¸€è‡´) ---
        const numberContainer = document.getElementById('numbers');
        const tickContainer = document.getElementById('ticks');
        
        for (let i = 1; i <= 12; i++) {
            const numDiv = document.createElement('div');
            numDiv.className = 'number';
            numDiv.innerText = i;
            const angle = (i * 30) * (Math.PI / 180); 
            const x = Math.sin(angle) * 130;
            const y = -Math.cos(angle) * 130;
            numDiv.style.transform = `translate(-50%, -50%) translate(${x}px, ${y}px)`;
            numberContainer.appendChild(numDiv);
        }

        for (let i = 0; i < 60; i++) {
            const tick = document.createElement('div');
            tick.className = i % 5 === 0 ? 'tick large' : 'tick';
            tick.style.transform = `rotate(${i * 6}deg)`;
            tickContainer.appendChild(tick);
        }

        // --- æ ¸å¿ƒé€»è¾‘ ---
        let totalMinutes = 12 * 60; 
        const hourHand = document.getElementById('hourHand');
        const minuteHand = document.getElementById('minuteHand');
        const timeDisplay = document.getElementById('timeDisplay');
        const clockFace = document.getElementById('clockFace');

        // æ›´æ–°æ—¶é’Ÿç”»é¢
        // animateå‚æ•°ï¼šå¦‚æœæ˜¯æŒ‰é’®ç‚¹å‡»ï¼Œè®¾ä¸ºtrueï¼ˆå¹³æ»‘ï¼‰ï¼›å¦‚æœæ˜¯æ‹–æ‹½ï¼Œè®¾ä¸ºfalseï¼ˆè·Ÿæ‰‹ï¼‰
        function updateClock(animate = true) {
            // åˆ†é’ˆï¼šæ¯åˆ†é’Ÿèµ°6åº¦
            const minDeg = totalMinutes * 6;
            // æ—¶é’ˆï¼šæ¯åˆ†é’Ÿèµ°0.5åº¦
            const hourDeg = totalMinutes * 0.5;

            // æ ¹æ®æ˜¯å¦éœ€è¦åŠ¨ç”»åˆ‡æ¢ CSS transition
            const transitionStyle = animate ? "transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)" : "none";
            minuteHand.style.transition = transitionStyle;
            hourHand.style.transition = transitionStyle;

            minuteHand.style.transform = `translate(-50%, 0) rotate(${minDeg}deg)`;
            hourHand.style.transform = `translate(-50%, 0) rotate(${hourDeg}deg)`;
            
            // æ›´æ–°æ•°å­—æ˜¾ç¤º
            let displayH = Math.floor(totalMinutes / 60) % 12;
            let displayM = Math.floor(totalMinutes % 60);

            // å¤„ç† 0ç‚¹/12ç‚¹ å’Œ è´Ÿæ•° çš„é€»è¾‘
            if (displayM < 0) displayM = (displayM % 60 + 60) % 60;
            if (displayH <= 0) displayH = (displayH % 12 + 12) % 12; 
            if (displayH === 0) displayH = 12; 

            const strM = displayM < 10 ? '0' + displayM : displayM;
            timeDisplay.innerText = `${displayH}:${strM}`;
        }

        // æŒ‰é’®ç‚¹å‡»å¢åŠ æ—¶é—´ (å¸¦åŠ¨ç”»)
        function addTimeButton(minutesToAdd) {
            totalMinutes += minutesToAdd;
            updateClock(true);
        }

        // è®¾ç½®ç‰¹å®šæ—¶é—´
        function setSpecificTime(h, m) {
            let targetDayMinutes = (h % 12) * 60 + m;
            if (targetDayMinutes === 0) targetDayMinutes = 12 * 60;

            let currentDayMinutes = totalMinutes % (12 * 60);
            if (currentDayMinutes === 0 && totalMinutes > 0) currentDayMinutes = 12 * 60;

            let diff = targetDayMinutes - currentDayMinutes;
            if (diff <= 0) diff += 12 * 60; // ä¿è¯é¡ºæ—¶é’ˆèµ°

            totalMinutes += diff;
            updateClock(true);
        }

        function resetTime() {
            // é‡ç½®å›æœ€è¿‘çš„12ç‚¹
            let remainder = totalMinutes % 720;
            let toAdd = 720 - remainder;
            totalMinutes += toAdd;
            updateClock(true);
        }

        // --- æ‹–æ‹½äº¤äº’é€»è¾‘ (æ–°å¢éƒ¨åˆ†) ---
        let isDragging = false;
        let activeHandType = null;
        let lastAngle = 0;

        // ç»‘å®šäº‹ä»¶ (æ”¯æŒé¼ æ ‡å’Œè§¦æ‘¸)
        [hourHand, minuteHand].forEach(hand => {
            hand.addEventListener('mousedown', startDrag);
            hand.addEventListener('touchstart', startDrag, { passive: false });
        });

        window.addEventListener('mousemove', doDrag);
        window.addEventListener('touchmove', doDrag, { passive: false });
        window.addEventListener('mouseup', endDrag);
        window.addEventListener('touchend', endDrag);

        function getEventPosition(e) {
            if (e.touches && e.touches.length > 0) {
                return { x: e.touches[0].clientX, y: e.touches[0].clientY };
            }
            return { x: e.clientX, y: e.clientY };
        }

        // è®¡ç®—è§’åº¦ (0ç‚¹æ–¹å‘ä¸º0åº¦)
        function calculateAngle(x, y) {
            const rect = clockFace.getBoundingClientRect();
            const cx = rect.left + rect.width / 2;
            const cy = rect.top + rect.height / 2;
            // atan2 çš„ç»“æœæ˜¯ -PI åˆ° PIï¼Œ0æ˜¯3ç‚¹é’Ÿæ–¹å‘
            const radians = Math.atan2(y - cy, x - cx);
            let degrees = radians * (180 / Math.PI) + 90;
            if (degrees < 0) degrees += 360;
            return degrees;
        }

        function startDrag(e) {
            e.preventDefault(); // é˜²æ­¢æ‹–æ‹½æ—¶é¡µé¢è·Ÿç€åŠ¨
            isDragging = true;
            activeHandType = e.currentTarget.dataset.type; // è¯†åˆ«æŠ“çš„æ˜¯å“ªä¸ªé’ˆ
            
            const pos = getEventPosition(e);
            lastAngle = calculateAngle(pos.x, pos.y);
            
            // æ‹–æ‹½å¼€å§‹ï¼Œå…³é—­åŠ¨ç”»
            updateClock(false);
        }

        function doDrag(e) {
            if (!isDragging) return;
            e.preventDefault();

            const pos = getEventPosition(e);
            const currentAngle = calculateAngle(pos.x, pos.y);
            
            // è®¡ç®—è§’åº¦å·®å€¼
            let delta = currentAngle - lastAngle;
            // å¤„ç† 360åº¦/0åº¦ äº¤ç•Œå¤„çš„çªå˜
            if (delta > 180) delta -= 360;
            if (delta < -180) delta += 360;

            // æ ¹æ®æŠ“çš„æ˜¯åˆ†é’ˆè¿˜æ˜¯æ—¶é’ˆï¼Œæ›´æ–°æ—¶é—´
            if (activeHandType === 'minute') {
                // åˆ†é’ˆè½¬1åº¦ = 1/6 åˆ†é’Ÿ
                totalMinutes += delta / 6;
            } else if (activeHandType === 'hour') {
                // æ—¶é’ˆè½¬1åº¦ = 2 åˆ†é’Ÿ (å› ä¸ºæ—¶é’ˆèµ°ä¸€åœˆæ˜¯720åˆ†é’Ÿï¼Œ360åº¦å¯¹åº”720åˆ†)
                totalMinutes += delta * 2;
            }

            lastAngle = currentAngle;
            updateClock(false); // å®æ—¶æ›´æ–°ï¼Œæ— å»¶è¿Ÿ
        }

        function endDrag() {
            if (isDragging) {
                isDragging = false;
                activeHandType = null;
                // æ‹–æ‹½ç»“æŸåï¼ŒæŠŠæ—¶é—´å–æ•´åˆ°æœ€è¿‘çš„åˆ†é’Ÿï¼Œé¿å…å‡ºç°å°æ•°
                totalMinutes = Math.round(totalMinutes);
                updateClock(true); // æ¢å¤ä¸€ç‚¹å¼¹æ€§åŠ¨ç”»æ•ˆæœ
            }
        }

        // åˆå§‹åŒ–
        updateClock();
    </script>
</body>
</html>
